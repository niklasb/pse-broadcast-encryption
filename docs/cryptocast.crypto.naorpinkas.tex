\subsection{Package \lstinline!cryptocast.crypto.naorpinkas!}
An implementation of the Naor-Pinkas protocol based on the primitives provided by the crypto
 subpackage.
\input{cryptocast.crypto.naorpinkas.custom.tex}
\subsubsection{Class \lstinline|NaorPinkasClient|}
A client in the Naor-Pinkas broadcast encryption scheme. \\
\noindent\begin{minipage}[t]{5cm}
\vspace{0.3em}
\hspace*{2em}
\begin{tikzpicture}
\umlclass[]{NaorPinkasClient}{

}{
+ decrypt(cipher : byte[]) : BigInteger
}
\end{tikzpicture}
\vspace{0.3em}
\end{minipage}



\textbf{\sffamily Superclasses and Interfaces}
\begin{itemize}
\item \lstinline|cryptocast.crypto.Decryptor<BigInteger>|
\end{itemize}


\textbf{\sffamily Constructors}
\begin{itemize}
\item \lstinline|public| \lstinline|NaorPinkasClient|\lstinline|(NaorPinkasPersonalKey key)|\\ \\[-0.6em]
Initializes a Naor-Pinkas broadcast client.
\begin{itemize}
\item \lstinline|key|: The personal key used to reconstruct a secret from the stream.
\end{itemize}



\end{itemize}


\textbf{\sffamily Methods}
\begin{itemize}
\item \lstinline|public BigInteger| \lstinline|decrypt|\lstinline|(byte[] cipher)|\\ \\[-0.6em]
Decrypts a secret.
\begin{itemize}
\item \lstinline|cipher|: The encrypted secret
\end{itemize}

\emph{Returns:} The decrypted secret

\end{itemize}

\subsubsection{Class \lstinline|NaorPinkasServer|}
A server in the Naor-Pinkas broadcast encryption scheme. It knows
 the entire polynomial and therefore all the private keys of its users. This makes the implementation
 of the interpolation algorithm a bit more efficient. \\
\noindent\begin{minipage}[t]{5cm}
\vspace{0.3em}
\hspace*{2em}
\begin{tikzpicture}
\umlclass[]{NaorPinkasServer}{

}{
+ encrypt(secret : BigInteger) : byte[] \\ + getIdentity(i : int) : NaorPinkasIdentity \\ + revoke(x : NaorPinkasIdentity) \\ + isRevoked(id : NaorPinkasIdentity) : boolean \\ + getPersonalKey(id : NaorPinkasIdentity) : NaorPinkasPersonalKey
}
\end{tikzpicture}
\vspace{0.3em}
\end{minipage}



\textbf{\sffamily Superclasses and Interfaces}
\begin{itemize}
\item \lstinline|cryptocast.crypto.BroadcastSchemeKeyManager<NaorPinkasIdentity>|
\item \lstinline|cryptocast.crypto.BroadcastSchemeUserManager<NaorPinkasIdentity>|
\item \lstinline|cryptocast.crypto.Encryptor<BigInteger>|
\item \lstinline|java.io.Serializable|
\end{itemize}



\textbf{\sffamily Methods}
\begin{itemize}
\item \lstinline|public byte[]| \lstinline|encrypt|\lstinline|(BigInteger secret)|\\ \\[-0.6em]
Encrypts a secret.
\begin{itemize}
\item \lstinline|secret|: the secret
\end{itemize}

\emph{Returns:} The cipher text

\item \lstinline|public NaorPinkasIdentity| \lstinline|getIdentity|\lstinline|(int i)|\\ \\[-0.6em]
\emph{Returns:} The identity with the given index
\begin{itemize}
\item \lstinline|i|: An index
\end{itemize}



\item \lstinline|public void| \lstinline|revoke|\lstinline|(NaorPinkasIdentity x)|\\ \\[-0.6em]
Revokes a user.



\item \lstinline|public boolean| \lstinline|isRevoked|\lstinline|(NaorPinkasIdentity id)|\\ \\[-0.6em]
\emph{Returns:} Whether the user is revoked.
\begin{itemize}
\item \lstinline|id|: The identity of the user
\end{itemize}



\item \lstinline|public NaorPinkasPersonalKey| \lstinline|getPersonalKey|\lstinline|(NaorPinkasIdentity id)|\\ \\[-0.6em]
\emph{Returns:} The private key of the user
\begin{itemize}
\item \lstinline|id|: The identity to look up
\end{itemize}



\end{itemize}

\subsubsection{Class \lstinline|NaorPinkasPersonalKey|}
A user's personal key in the Naor-Pinkas broadcast encryption scheme. \\
\noindent\begin{minipage}[t]{5cm}
\vspace{0.3em}
\hspace*{2em}
\begin{tikzpicture}
\umlclass[]{NaorPinkasPersonalKey}{

}{
+ getAlgorithm() : String \\ + getEncoded() : byte[] \\ + getFormat() : String
}
\end{tikzpicture}
\vspace{0.3em}
\end{minipage}



\textbf{\sffamily Superclasses and Interfaces}
\begin{itemize}
\item \lstinline|java.security.PrivateKey|
\end{itemize}



\textbf{\sffamily Methods}
\begin{itemize}
\item \lstinline|public String| \lstinline|getAlgorithm|\lstinline|()| \\[-0.6em]




\item \lstinline|public byte[]| \lstinline|getEncoded|\lstinline|()| \\[-0.6em]




\item \lstinline|public String| \lstinline|getFormat|\lstinline|()| \\[-0.6em]




\end{itemize}

\subsubsection{Class \lstinline|NaorPinkasShareCombinator|}
Allows to restore a number from a sufficient number of Naor-Pinkas shares. \\
\noindent\begin{minipage}[t]{5cm}
\vspace{0.3em}
\hspace*{2em}
\begin{tikzpicture}
\umlclass[]{NaorPinkasShareCombinator}{

}{
+ restore(shares : Collection<NaorPinkasShare>) : Optional<BigInteger>
}
\end{tikzpicture}
\vspace{0.3em}
\end{minipage}



\textbf{\sffamily Superclasses and Interfaces}
\begin{itemize}
\item \lstinline|cryptocast.crypto.ShareCombinator<BigInteger, NaorPinkasShare>|
\end{itemize}



\textbf{\sffamily Methods}
\begin{itemize}
\item \lstinline|public Optional<BigInteger>| \lstinline|restore|\lstinline|(Collection<NaorPinkasShare> shares)|\\ \\[-0.6em]
Restores a secret from several Naor-Pinkas shares.
\begin{itemize}
\item \lstinline|shares|: The shares
\end{itemize}

\emph{Returns:} The reconstructed secret or absent if the information represented
 by the given shares is insufficient to restore it.

\end{itemize}

\subsubsection{Class \lstinline|NaorPinkasShare|}
A share in the Naor-Pinkas broadcast encryption scheme. It consists of a tuple
 $(r, I, g^{r P(I)})$. $t + 1$ distinct shares of this form are sufficient to restore the
 value $g^{r P(0)}$, where $t$ is the degree of the polynomial $P$. \\
\noindent\begin{minipage}[t]{5cm}
\vspace{0.3em}
\hspace*{2em}
\begin{tikzpicture}
\umlclass[]{NaorPinkasShare}{

}{

}
\end{tikzpicture}
\vspace{0.3em}
\end{minipage}





\subsubsection{Class \lstinline|NaorPinkasIdentity|}
An identity in the Naor-Pinkas broadcast encryption scheme \\
\noindent\begin{minipage}[t]{5cm}
\vspace{0.3em}
\hspace*{2em}
\begin{tikzpicture}
\umlclass[]{NaorPinkasIdentity}{

}{
-- getId() : BigInteger
}
\end{tikzpicture}
\vspace{0.3em}
\end{minipage}




\textbf{\sffamily Constructors}
\begin{itemize}
\item \lstinline|private| \lstinline|NaorPinkasIdentity|\lstinline|(BigInteger id)| \\[-0.6em]




\end{itemize}


\textbf{\sffamily Methods}
\begin{itemize}
\item \lstinline|private BigInteger| \lstinline|getId|\lstinline|()| \\[-0.6em]




\end{itemize}


