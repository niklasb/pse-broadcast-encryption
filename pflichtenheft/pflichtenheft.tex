\documentclass[a4paper,10pt]{scrartcl}
\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}
\usepackage[T1]{fontenc}
\usepackage{booktabs}
\usepackage{xspace}
\usepackage{enumitem}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{fit}
\usetikzlibrary{calc}
\usepackage{float}
\usepackage[section]{placeins} % don't move figures beyond the next section heading

% this is needed for forms and links within the text
\usepackage{hyperref}

% glossary, see http://en.wikibooks.org/wiki/LaTeX/Glossary
% has to be loaded AFTER hyperref so that entries are clickable
\usepackage[nonumberlist]{glossaries}

\makeglossary

% Variables
\newcommand{\authors}{
   Mohammed~Abu~Jayyab,
   Niklas~Baumstark,
   Tobias~Gräf,
   Amrei~Loose\xspace
}
\newcommand{\authorName}{ \authors, Christoph~Michel }
\newcommand{\authorNameEmph}{ \authors, \textbf{Christoph~Michel} }

\newcommand{\dateFirstVersion}{\today}
\newcommand{\customer}{Karlsruher Institut für Technologie}
\newcommand{\contractor}{Eine Firma}
\newcommand{\projectName}{Broadcast-Verschlüsselung\xspace}
\newcommand{\tags}{
   \authorName,
   Pflichtenheft,
   KIT,
   Informatik,
   PSE,
   Broadcast-Verschlüsselung
}
\newcommand{\glossarName}{Glossar}
\newcommand{\doctitle}{\projectName (Pflichtenheft)}
\title{\doctitle}
\author{\authorName}
\date{\today}

\include{style}

\begin{document}

\input{frontpage}
\tableofcontents
\clearpage

\section{Einleitung}

Heutzutage gängige Streamingdienste im Internet basieren bis auf wenige Ausnahmen auf
einem Client-Server-Modell, bei dem jeder Client eine eigene Verbindung zum Server
aufbaut, um einen Stream zu empfangen. Das Trafficaufkommen, das durch diese Art der
Kommunikation verursacht wird sowie die notwendige Bandbreite sind enorm. Nur große
Anbieter von Inhalten können sich diese Form der Verteilung überhaupt leisten.

Mit der naheliegenden Erkenntnis, dass bei dem beschriebenen Verfahren dieselben Daten
vielfach an verschiedene Empfänger versendet werden, ergibt sich ein alternatives
Vorgehen auf der Basis von Multicast: Inhalte werden vom Server nur einmal versendet
und über das Internet an mehrere Empfänger zugestellt. Damit wird vor allem der Sender,
aber auch die gesamte Internet-Infrastruktur entlastet.

Ein großes Problem stellt allerdings die Zugangskontrolle für diese Multicast-Streams
dar: Da nun der Server nicht mehr weiß, wer eigentlich den Stream empfängt, kann
er auch nicht verhindern, dass unauthorisierte Benutzer Zugang erhalten. Die Lösung
dieses Problems erfordert den Einsatz von speziellen Verschlüsselungsverfahren,
sodass zwar jeder den Stream empfangen, aber nur authorisierte Benutzer den Stream
entschlüsseln können. Besonderes Augenmerk muss dabei auf Effizienz gelegt werden,
da der Kommunikationsaufwand durch die Verschlüsselung nicht wesentlich erhöht werden
darf.

Wir wurden daher beauftragt, einen Prototyp zu entwickeln, der ein
Broadcast"=Verschlüsselungsverfahren mit speziellen wünschenswerten Eigenschaften
demonstriert.

\section{Zielbestimmung}

Die entwickelte Software ist eine Client/Server-Kombination, die es ermöglicht,
Inhalte verschlüsselt von einem Server an verschiedene Clients verteilen. Dafür
soll kein bidirektionales Kommunikationsmedium erforderlich sein.

Die Clients werden auf Basis des g"angigen mobilen Betriebssystems Android
implementiert.

Es wird ein Verschlüsselungsverfahren eingesetzt, welches die besondere
Eigenschaft besitzt, nicht mit der Gesamtzahl der Empfänger, sondern mit der Anzahl
ausgeschlossener Benutzer zu skalieren.

\subsection{Musskriterien}

\begin{itemize}

\item Server
\begin{itemize}
   \item sendet Daten an eine Empfängergruppe. Zu Demonstrationszwecken wird
         ein einfacher Audio- oder Videostream als Payload eingesetzt.
   \item erlaubt es, nicht mehr authorisierte Benutzer auszuschließen.
\end{itemize}

\item Client
\begin{itemize}
   \item erlaubt es, sich mit einem Server zu verbinden (einer Gruppe beizutreten).
   \item empfängt Daten vom Server und stellt sie dar.
   \item merkt sich zuletzt ausgew"ahlte Server, sodass ein erneuter Zugriff schnell
         m"oglich ist.
\end{itemize}

\item Kommunikation und Verschl"usselung
\begin{itemize}
   \item Nur ein unidirektionaler Kommunikationskanal vom Server zum Client wird
         vorausgesetzt. Zu Demonstrationszwecken wird TCP als Transportprotokoll
         verwendet, aber auch zuverl"assige Multicastprotokolle k"amen als Medium
         infrage.
   \item Daten werden verschl"usselt "ubertragen. Der Server bietet entsprechende
         Optionen zur Erzeugung von Schl"usseln und zur Kontrolle und Konfiguration
         der Verschl"usselungsschicht. "Uber einen externen, sicheren Kanal erh"alt
         jeder Benutzer einen privaten Schl"ussel (z.B. eine Datei), mit dem er seine
         Clientsoftware konfigurieren kann.
   \item Das verwendete Broadcast"=Verschl"usselungsverfahren basiert auf den
         in~\cite[Section~2.2]{Naor00} oder~\cite{Garg10} beschriebenen Verfahren
         oder einer Variante der Algorithmen mit vergleichbaren kryptografischen
         Eigenschaften.
   \item Die Verschl"usselung erfordert im laufenden Betrieb nur einen
         Kommunikationsoverhead, der sublinear in der Gesamtanzahl der Benutzer und
         stattdessen linear oder quasilinear in der Anzahl der ausgeschlossenen
         Benutzer ist.
\end{itemize}
\end{itemize}
\newpage
\subsection{Wunschkriterien}

\begin{itemize}

\item Server
\begin{itemize}
   \item f"uhrt Statistik "uber Nutzdatenmenge und Traffic, um den Kommunikationsaufwand
         der Verschl"usselung zu analysieren.
\end{itemize}

\item Client
\begin{itemize}
   \item verf"ugt "uber eine Anzeige des angefallenen Traffics.
   \item puffert oder speichert Inhalte, sodass z.B. in einem Stream auch
         zur"uckgespult werden kann.
\end{itemize}

\item Kommunikation und Verschl"usselung
\begin{itemize}
   \item Ein effizienteres Verfahren als das in~\cite{Naor00} beschriebene wird
         entwickelt und implementiert.
\end{itemize}
\end{itemize}

\subsection{Abgrenzungskriterien}
\begin{itemize}
   \item Es wird kein Framework zur Verf"ugung gestellt, welches verschiedene
         Streamtypen implementiert. Stattdessen bleibt die Implementierung
         unabh"angig von den zugrundeliegenden Nutzdaten und ist so flexibel,
         dass eine konkrete Implementierung eines neuen Streamtyps problemlos
         m"oglich ist.
   \item Es wird kein Multicast-Protokoll implementiert. Stattdessen wird
         zur Demonstrationszwecken TCP zur Kommunikation benutzt und die Software
         ist so flexibel, dass eine Adaptation an ein zuverl"assiges
         Multicastverfahren problemlos m"oglich ist.
\end{itemize}

\section{Produkteinsatz}

Das Produkt wird benutzt um Inhalte an eine festgelegte Benutzergruppe zu verteilen. 

\subsection{Anwendungsbereich}

Durch die Beliebigkeit des Datentyps kann das Produkt in allen Bereichen zum Einsatz kommen, die das Verteilen von Daten an
bestimmte Nutzergruppen erfordern. Beispielsweise in den Bereichen Pay-TV, Blu-ray, Audio-Video-Streaming oder Digital-Rights-Management.
Da das Verfahren eine sehr breite Verteilung erm"oglicht, bietet es sich unter anderem für das Live-Streaming bedeutender Events an.
Dabei kommt es aufgrund großen "offentlichen Interesses häufig zur Überlastung der Server, was mithilfe der entwickelten Software umgangen werden k"onnte.

Mithilfe der Verschl"usselung kann das Programm auch für kostenpflichtige Internetdienste wie Pay-TV, Zeitschriften,  etc. verwendet werden.

\subsection{Zielgruppen}

Es gibt in diesem Fall zwei Zielgruppen: Die der Dienstanbieter und die der Nutzer.

Die Dienstanbieter sind die Betreiber der Server von denen aus Datenmengen an die Nutzer versendet werden. Diese Anbieter möchten die Möglichkeit haben bestimmte Nutzer auszuschließen.

Die Nutzer wollen die Dienstleistung in Anspruch nehmen und Daten empfangen.

\subsection{Betriebsbedingungen}

Der Server läuft im unbeaufsichtigten, stationären Dauerbetrieb.

Der Client wird mobil und nur auf Anfrage benötigt.

\section{Produktfunktion}

\subsection{Grundfunktionen}

\begin{usecase}
\addheading{Nummer}{Beschreibung}
\addrow{/FA10/} {Der Server versendet Daten an eine Empf"angergruppe.}
\addrow{/FA20/} {Der Server bietet die M"oglichkeit eines Rekeyings, also
                 der Erzeugung eines komplett neuen Satzes private Schl"ussel
                 f"ur die Benutzer. Diese m"ussen dann auf einem sicheren
                 Weg zugestellt werden}
\addrow{/FA30/} {Der Server verschl"usselt Daten so, dass nur authorisierte
                 Benutzer den Stream entschl"usseln k"onnen.}
\addrow{/FA40/} {Der Server bietet die M"oglichkeit, Nutzer per Namen auszuschließen,
                 ohne dass ein Rekeying erforderlich ist.}
\addrow{/FA50/} {Der Client bietet die M"oglichkeit, sich zu einem Server verbinden.}
\addrow{/FA60/} {Der Client empf"angt Daten und stellt sie dar.}
\addrow{/FA70/} {Der Client erlaubt die Angabe eines privaten Schl"ussels, der von
                 einem Server erzeugt wurde.}
\addrow{/FA80/} {Der Client kann Daten entschlüsseln, nachdem er mit einem
                 g"ultigen Schl"ussel konfiguriert wurde und solange er nicht
                 vom Server explizit ausgeschlossen wurde.}
\addrow{/FA90/} {Der Client merkt sich die letzten ausgewählten Server mit
                 zugeh"origem Schl"ussel, sodass ein erneuter Zugriff schnell möglich
                 ist.}
\addrow{/FA100/} {Die Verschlüsselung erfolgt mit einer Variante des in~\cite[Section 2.2]{Naor00}
                  oder~\cite{Garg10} vorgestellten Verfahrens}
\end{usecase}

\subsection{Erweiterte Funktionen}

\begin{usecase}
\addheading{Nummer}{Beschreibung}
\addrow{/FA200/} {Der Benutzer kann im Client mehrere Serverfavoriten
                  mit Namen und Schl"usseln in einem dedizierten Optionsdialog verwalten,
                  welche dann über ein Kontextmenü auswählbar sind.}
\addrow{/FA210/} {Der Server führt Statistiken über Nutzdatenmenge und Traffic,
                  um den Kommunikationsaufwand für die Verschlüsselung zu
                  analysieren}
\addrow{/FA220/} {Der Client verfügt über eine Anzeige des angefallenen Traffics.}
\addrow{/FA230/} {Der Client verfügt über eine Anzeige des angefallenen Traffics.}
\addrow{/FA240/} {Um Kunden mit volumenbasierten Datentarifen nicht zu belasten,
                  bietet der Client einen WiFi-Modus, in dem er nur bei
                  verf"ugbarer drahtloser Netzwerkverbindung eine Verbindung erlaubt,
                  und nicht "uber das Telefonanbieternetz.}
\addrow{/FA250/} {Der Client puffert empfangene Daten, um eine flüssigere
                  Wiedergabe zu ermöglichen.}
\addrow{/FA260/} {Ein effizienteres Verschlüsselungsverfahren als das vorgebene
                  wird entwickelt und implementiert.}
\end{usecase}
\newpage
\section{Produktdaten}
Da die Software ist nicht zustänndig für die Erstellung und Versenden von Rechnungen
und stattdessen werden diese Funktionen von den Betreibern der Server unterstützt, 
werden die entsprechenden Daten nicht gespeichert.

\subsection{Grunddaten}
\begin{usecase}
\addheading{Nummer}{Beschreibung}
\addrow{/PD10/} {Server: Benutzerdaten
   \begin{itemize}
   \item Daten f"ur Verschl"usselung: User-ID, Privater Schl"ussel
   \item Persönliche Daten
	 \begin{itemize}
	 \item Vor- Nachname
   \end{itemize}
	 \end{itemize}
}
\addrow{/PD20/} {Client: Serverdaten
   \begin{itemize}
   \item (optional) Alias
   \item Hostname/IP
   \item TCP-Port
   \item Privater Schl"ussel
   \end{itemize}
}
\end{usecase}

\subsection{Erweiterte Daten}
\begin{usecase}
\addheading{Nummer}{Beschreibung}
\addrow{/PD30/} {Server/Client: Trafficstatistiken
   \begin{itemize}
   \item "ubertragene/empfangene Nutzdatenmenge
   \item "ubertragene/empfangene Datenmenge insgesamt
   \end{itemize}
}
\end{usecase}

\section{Produktumgebung}
Der Server muss auf einem Java-fähigen System laufen.
Der Client muss auf einem portablen Gerät auf Basis des Android-Betriebssystems laufen.
\subsection{Software}
\begin{itemize}
\item Client
   \begin{itemize}
      \item Betriebssystem: Android (mind. 2.1)
   \end{itemize}
\item Server
   \begin{itemize}
      \item Java-fähiges System
   \end{itemize}
\end{itemize}

\subsection{Hardware}
\begin{itemize}
\item Client
   \begin{itemize}
      \item Internetfähiges Smartphone
      \item Prozessor mind. 384 MB
      \item Auflösung 240x320 Pixel
   \end{itemize}
\item Server
   \begin{itemize}
      \item Internetfähiger Server
   \end{itemize}
\end{itemize}

\section{Systemmodell}

\input{figures/system_model}
\input{figures/communication_model}
\input{figures/user_model}

\subsection{Szenarien}
\subsection{Anwendungsfälle}
\begin{usecase}
\addheading{Nummer}{Beschreibung}
\addrow{/AF10/} {Anmeldung durch Kunde
   \begin{itemize}
   \item Teilnehmender Akteur: Kunde
   \item Eingangsbedingung: Der Kunde hat sein seinen Schlüssel erhalten
   \item Ausgangsaktion: 
       \begin{itemize}
       \item Der Kunde kann die gewünschten Daten ansehen
       \item Da der Kunde ausgeschlossen wurde bleibt ihm der Zugangg verwehrt und er kann die Daten nicht betrachten
       \end{itemize}
   \item Ereignissfluss: Der Kunde wird dazu aufgefordert den Anbieter und seinen Schlüssel einzugeben. Werden diese akzeptiert, so kann er die
             die Daten ansehen. Andernfalls wird er durch eine Fehlermeldung auf eine eventuelle Falscheingabe aufmerksam gemacht.
   \end{itemize}
}
\addrow{/AF20/} {Rekey
   \begin{itemize}
   \item Teilnehmender Akteur: Anbieter
   \item Eingangsbedingung: -
   \item Ausgangsaktion: Ein neues Satz privater Schlüssel wird gespeichert
   \item Ereignissfluss: Der Anbieter will ein neue Empfängergruppe eröffnen und lässt den Server einen neuen Satz privater Schlüssel zur
              Verteilung erstellen.
   \end{itemize}
}
\addrow{/AF30/} {Starte Datenübertragung
   \begin{itemize}
   \item Teilnehmender Akteur: Anbieter
   \item Eingangsbedingung: Es existiert eine Empfängergruppe.
   \item Ausgangsaktion: Kunden sind in der Lage die gesendeten Daten zu empfangen
   \item Ereignissfluss: Der Anbieter wählt Daten aus, die gesendet werden soll, aus und teilt diese dem Server mit. Diese Daten werden vom 
             Server verschlüsselt, so dass ausgeschlossene Nutzer sie nicht entschlüsseln können, und versandt, damit Kunden diese empfangen können
   \end{itemize}
}
\addrow{/AF40/} {Session-Key generieren PASSIERT NUR AUTOMATISCH?
   \begin{itemize}
   \item Teilnehmender Akteur: -
   \item Eingangsbedingung: Es existiert eine Empfängergruppe
   \item Ausgangsaktion: Ein neuer Session-Keyl wird gespeichert
   \item Ereignissfluss: 
   \end{itemize}
}
\addrow{/AF50/} {Kunde sperren
   \begin{itemize}
   \item Teilnehmender Akteur: Anbieter
   \item Eingangsbedingung: Es existiert eine Empfängergruppe
   \item Ausgangsaktion: Der betreffende Kunde kann die Daten nicht mehr entschlüsseln
   \item Ereignissfluss: Der Anbieter teilt dem Server mit welchen Kunden er ausschließen möchte. Die betreffenden Daten werden vom Server gespeichert und
               beim zukünftigen generieren des Session-Keys berücksichtigt, Außerdem wird sofort ein neuer Session-Key generiert, damit die Änderungen sofort wirksam werden.
   \end{itemize}
}
\addrow{/AF60/} {Kunde hinzufügen
   \begin{itemize}
   \item Teilnehmender Akteur: Anbieter
   \item Eingangsbedingung: Es existiert eine Empfängergruppe
   \item Ausgangsaktion: Es wird angezeigt welcher Schlüssel dem Kunde zugeordnet wurde
   \item Ereignissfluss: Der Anbieter übergibt dem Server die nötigen Daten über den Kunden. Dieser speichert die Informationen und ordnet dem Kunden 
               einen privaten Schlüssel zu, welchen er auch anzeigt.
   \end{itemize}
}
\end{usecase}

\section{Produktleistung}

\begin{usecase}
\addheading{Nummer}{Beschreibung}
\addrow{/L10/} {Der Server und das Kommunikationssystem ist in der Lage,
                100000 Benutzer zu bedienen, von denen h"ochestens 1000 einen
                privaten Schl"ussel besitzen, der aber ausgeschlossen ist.}
\addrow{/L20/} {Die Oberfläche der Client-Anwendung ist so intuitiv, dass jeder Benutzer
                sich innerhalb von höchstens 5 Minuten Einarbeitungszeit selbst
                zurechtfindet, ohne die Dokumentation konsultieren zu müssen.}
\addrow{/L30/} {Die Antwort auf einen Klick eines Benutzers erfolgt innerhalb von
                höchstens 200ms.}
\addrow{/L40/} {Die Dauer der Überprüfung der Anmeldedaten muss im Bereich von
                1-2 Sekunden liegen.}
\addrow{/L50/} {Bei fehlerhaften Eingaben wird dem Benutzer eine entsprechende
                Fehlermeldung angezeigt und die Korrektur der Eingabedaten soll möglich sein
                ohne die Eingabe wiederholt vornehmen zu müssen.}
\end{usecase}

\section{GUI}

\begin{illustration}{Der Ausgangsbildschirm, von dem aus es möglicht ist, zu einem Server zu verbinden.}
\includegraphics[width=150px]{figures/images/homescreen.jpg}
\end{illustration}
\begin{illustration}{Eine Fehlermeldung nach einer Falscheingabe oder ähnlichem.}
\includegraphics[width=150px]{figures/images/alert.jpg}
\end{illustration}
\begin{illustration}{Der optionale Optionsbildschirm entsprechend den Wunschkriterien.}
\includegraphics[width=150px]{figures/images/filebrowser.jpg}
\end{illustration}
\begin{illustration}{Der optionale Optionsbildschirm entsprechend den Wunschkriterien.}
\includegraphics[width=150px]{figures/images/optionscreen.jpg}
\end{illustration}
\begin{illustration}{Eine mögliche Abfolge von Befehlen in der Serverkonsole.}
\includegraphics[width=350px]{figures/images/serverterminal.jpg}
\end{illustration}

\section{Testfälle}

\begin{usecase}
\addheading{Nummer}{Beschreibung}
\addrow{/T10/} {Ein Benutzer möchte sich unter Benutzung seines Benutzernames und
                Passwortes anmelden, aber das Password ist nicht korrekt. Es wird eine
                Fehlermeldung angezeigt und der Benutzer hat die Möglichkeit, es noch
                einmal zu versuchen.}
\addrow{/T20/} {Ein Benutzer zahlt keine Gebühren mehr. Sein Zugang wird gesperrt.}
\addrow{/T30/} {Ein Benutzer möchte sein Konto löschen. Die Löschung des Kontos wird 
                akzeptiert und das Konto wird gelöscht.}
\end{usecase}

\subsection{Qualitätsanforderungen}

\begin{tabular}{|c|c|c|c|c|}
\hline
 & \sffamily \textbf{sehr wichtig}
 & \sffamily \textbf{wichtig}
 & \sffamily \textbf{weniger wichtig}
 & \sffamily \textbf{unwichtig} \\
\hline
Benutzungsfreundlichkeit &  &  \X & & \\
\hline
Korrektheit &  \X & & &  \\
\hline
Zuverlässigkeit &  \X & & & \\
\hline
Effizienz &   \X & & & \\
\hline
Robustheit &  & & &\\
\hline
Kompatibilität &  & & & \\
\hline
\end{tabular}

\section{Entwicklungsumgebung}
Im Wesentlichen analog zur Produktumgebung

\subsection{Software}
\begin{itemize}
\item Eclipse
\item Git
\end{itemize}
\subsection{Hardware}
\begin{itemize}
\item Rechner
\end{itemize}


\clearpage
\input{glossary}

\bibliography{../bibtex/references}{}
\bibliographystyle{plain}

\end{document}
